---
title: "Random Forest Custom"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(rpart) # using the tree implementation of rpart 

data("iris") # Example dataset to demonstrate the use of a random forest

# Define parameters:

number_of_trees = 100
m_of_M = 2 # Number of columns to consider
n = dim(iris)[1]
M = dim(iris)[2]
trees = list()
#Steps:
for(i in 1:number_of_trees){
  # sample dataset for each tree with replacement (bootstrap sample)
  rows = sample(1:n,size=n,replace=TRUE)  
  
  # sample columns for each tree but with n<M number of total columns
  cols = sample(1:M,size=m_of_M)
  
  # grow tree to largest extend possible (do not prune) and find best split
  baseLearner = rpart(formula = iris$Species ~., data = iris[rows,cols],method = "class")
  
  #predict
  res = predict(baseLearner)
  trees = c(trees,list(res))
}



# take majority vote for clasification or average for regression
for(i in 1:n){
  for (j in 1:number_of_trees){
    perTreeResult = trees[[j]][grepl(paste(c("(^|\\b)",i,"(\\.|\\b)"),collapse=""),row.names(trees[[j]])),]
    
  }
}

```